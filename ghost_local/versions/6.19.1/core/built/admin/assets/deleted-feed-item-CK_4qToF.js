import{r as u,j as e,B as y,f as b,bl as j,bm as p,bi as v,g as w,A as R,bd as N}from"./index-Bgo4hw-T.js";import{T}from"./trash-BKeiM6WP.js";const M=({count:t,onClick:l,variant:d="default",preserveScroll:r=!0,loading:c=!1})=>{const n=u.useRef(null),i=()=>{if(t&&t>0)return`Show ${t} more ${t===1?"reply":"replies"}`;switch(d){case"expand":return"Show replies";case"loadMore":return"Show more replies";default:return"Show replies"}},a=()=>{if(r){const s=document.querySelector("[data-scrollable-container]"),o=s?s.scrollTop:window.scrollY;l(),setTimeout(()=>{s?s.scrollTop=o:window.scrollTo(0,o)},0)}else l()};return e.jsxs("div",{ref:n,className:"mt-[-7px] flex items-center pb-3",children:[e.jsxs("div",{className:"flex w-10 flex-col items-center justify-center gap-1",children:[e.jsx("div",{className:"size-0.5 rounded-sm bg-gray-300"}),e.jsx("div",{className:"size-0.5 rounded-sm bg-gray-300"}),e.jsx("div",{className:"size-0.5 rounded-sm bg-gray-300"})]}),e.jsx(y,{className:"hover:text-blue-800 text-sm font-medium text-blue-600",variant:"ghost",onClick:s=>{s.preventDefault(),s.stopPropagation(),s.target.blur(),a()},children:c?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{size:"sm"}),e.jsx("span",{children:"Loading..."})]}):i()})]})};function A(t,l={}){const{includeAncestors:d=!1}=l,{data:r,isLoading:c,loadMoreChildren:n,loadMoreChildReplies:i,hasMoreChildren:a,hasMoreChildReplies:s}=j("index",t),o=d?r?.ancestors?.chain?.map(p)||[]:[],m=r?.post?p(r.post):void 0,h=(r?.children??[]).map(x=>{const f=p(x.post),g=x.chain?x.chain.map(p):[];return{mainReply:f,chain:g}});return{threadParents:o,post:m,processedReplies:h,isLoading:c,loadMoreChildren:n,loadMoreChildReplies:i,hasMoreChildren:a,hasMoreChildReplies:s}}const z=({object:t,onReply:l,onReplyError:d,className:r,...c})=>{const{data:n}=v("index"),[i,a]=u.useState(!1);if(!n)return null;const s=t.attributedTo;let o="Reply...";return s?.preferredUsername&&s?.id&&(o=`Reply to ${w(s)}...`),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`flex w-full cursor-pointer gap-x-3 py-6 ${r||""}`,onClick:()=>a(!0),...c,children:[e.jsx(R,{author:n}),e.jsx("div",{className:"flex w-full items-center",children:e.jsx("div",{className:"w-full text-[1.5rem] text-gray-500 transition-colors dark:text-gray-400",children:o})})]}),i&&e.jsx(N,{open:i,replyTo:{object:t,actor:t.attributedTo},onOpenChange:m=>{a(m)},onReply:()=>{l?.(),a(!1)},onReplyError:()=>{d?.()}})]})},P=({last:t})=>e.jsxs("div",{className:"relative mt-[-5px] py-5",children:[e.jsxs("div",{className:"flex h-12 grow items-center gap-2 rounded-lg border border-gray-200 p-2 px-[10px] text-gray-600",children:[e.jsx(T,{size:18,strokeWidth:1.25}),"This post has been deleted"]}),!t&&e.jsx("div",{className:"absolute bottom-0 left-[18px] top-[70px] z-0 mb-[-13px] w-[2px] rounded-sm bg-gray-200"})]});export{z as A,P as D,M as S,A as u};
