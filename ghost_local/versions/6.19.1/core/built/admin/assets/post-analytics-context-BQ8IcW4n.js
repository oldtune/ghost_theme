import{r as c,u as v,aI as p,aJ as y,aK as h,aL as D,j as C}from"./index-Bgo4hw-T.js";import{u as I}from"./posts-C94RiQ4S.js";const k={TODAY:{name:"Today",value:1},LAST_7_DAYS:{name:"Last 7 days",value:7},LAST_30_DAYS:{name:"Last 30 days",value:31},LAST_90_DAYS:{name:"Last 90 days",value:91},YEAR_TO_DATE:{name:"Year to date",value:366},LAST_12_MONTHS:{name:"Last 12 months",value:372},ALL_TIME:{name:"All time",value:1e3}},U={US:"United States",TWN:"Taiwan",TW:"Taiwan",CN:"China","mobile-ios":"iOS","mobile-android":"Android",macos:"macOS","google.com":"Google","ghost.org":"Ghost","bing.com":"Bing","bsky.app":"Bluesky","yahoo.com":"Yahoo","duckduckgo.com":"DuckDuckGo"},x=["NULL","ᴺᵁᴸᴸ","","Others","Other"],t={PUBLIC:1,FREE:2,PAID:4},Y=t.PUBLIC|t.FREE|t.PAID,G=[{name:"Public visitors",value:"undefined",bit:t.PUBLIC},{name:"Free members",value:"free",bit:t.FREE},{name:"Paid members",value:"paid",bit:t.PAID}],m=c.createContext(void 0),w=()=>{const o=c.useContext(m);if(!o)throw new Error("useGlobalData must be used within a PostAnalyticsProvider");return o},B=({children:o})=>{const{postId:a}=v();if(!a)throw new Error("Post ID is required for PostAnalyticsProvider");const e=p(),s=y(),[g,A]=c.useState(k.LAST_30_DAYS.value),d=h(),n=!!e.data?.config?.stats,i=D({enabled:n}),{data:{posts:[S]}={posts:[]},isLoading:L}=I({searchParams:{filter:`id:${a}`,include:"email,authors,tags,tiers,count.clicks,count.signups,count.paid_conversions,count.positive_feedback,count.negative_feedback,newsletter"}}),u=[e,s,d],T=u.map(r=>r.error).find(Boolean),_=n?i.error:null,l=T||_,b=u.some(r=>r.isLoading),E=n?i.isLoading:!1,P=b||E;if(l)throw l;const f=s.data?.site?{url:s.data.site.url,icon:s.data.site.icon,title:s.data.site.title}:void 0;return C.jsx(m.Provider,{value:{data:e.data?.config,site:f,statsConfig:e.data?.config?.stats,tinybirdToken:i.token,isLoading:P,range:g,setRange:A,settings:d.data?.settings||[],postId:a,post:S,isPostLoading:L},children:o})},R=Object.freeze(Object.defineProperty({__proto__:null,default:B,useGlobalData:w},Symbol.toStringTag,{value:"Module"}));export{Y as A,k as S,x as U,U as a,G as b,t as c,R as p,w as u};
